name: ROS CNIP list

on:
  schedule:
    - cron: "10 * * * *"
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout
      uses: actions/checkout@v2
     
    - name: Combine
      run: |
        sudo timedatectl set-timezone "Asia/Shanghai"
        echo -e "(curl -kLfsm 5 https://ispip.clang.cn/all_cn.txt)" | sed -e 's/^/add address=/g' -e 's/$/ list=CNIP/g' | sed -e $'1i\\\n/ip firewall address-list' -e $'1i\\\nremove [/ip firewall address-list find list=CNIP] list=CNIP' > cnip.rsc
